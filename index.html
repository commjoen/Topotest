<!DOCTYPE html>
<html lang="nl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Topotest - Nederlandse Topografie Quiz</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <div class="container">
        <header>
            <h1>Topotest</h1>
            <p class="subtitle">Leer de Nederlandse topografie!</p>
        </header>

        <div class="game-container">
            <div class="level-selector">
                <button id="level1-btn" class="level-btn active" onclick="selectLevel(1)">
                    Level 1: Provincies & Hoofdsteden
                </button>
                <button id="level2-btn" class="level-btn" onclick="selectLevel(2)">
                    Level 2: Wateren
                </button>
                <button id="level3-btn" class="level-btn" onclick="selectLevel(3)">
                    Level 3: Noordelijke Steden
                </button>
                <button id="level4-btn" class="level-btn" onclick="selectLevel(4)">
                    Level 4: Oostelijke Steden & Rivieren
                </button>
            </div>
            
            <div class="level-selector-mobile">
                <label for="level-dropdown">Kies Level:</label>
                <select id="level-dropdown" class="level-dropdown" onchange="selectLevel(parseInt(this.value))">
                    <option value="1">Level 1: Provincies & Hoofdsteden</option>
                    <option value="2">Level 2: Wateren</option>
                    <option value="3">Level 3: Noordelijke Steden</option>
                    <option value="4">Level 4: Oostelijke Steden & Rivieren</option>
                </select>
            </div>

            <div class="settings-container">
                <div class="setting">
                    <label for="num-questions">Aantal vragen:</label>
                    <input type="text" id="num-questions" placeholder="all" value="all">
                </div>
                <div class="setting">
                    <label for="enable-timer">Timer:</label>
                    <input type="checkbox" id="enable-timer">
                    <span id="timer-display" style="display: none;">Tijd: <span id="timer-value">0:00</span></span>
                </div>
            </div>

            <div class="stats">
                <div class="stat">
                    <span class="stat-label">Score:</span>
                    <span id="score" class="stat-value">0</span>
                </div>
                <div class="stat">
                    <span class="stat-label">Record:</span>
                    <span id="high-score" class="stat-value">0</span>
                </div>
                <div class="stat">
                    <span class="stat-label">Vraag:</span>
                    <span id="question-number" class="stat-value">0/0</span>
                </div>
            </div>

            <div class="map-container">
                <div class="map-zoom-controls">
                    <button id="zoom-in-btn" class="zoom-btn" onclick="zoomIn()" title="Zoom in">+</button>
                    <button id="zoom-out-btn" class="zoom-btn" onclick="zoomOut()" title="Zoom uit">−</button>
                    <button id="zoom-reset-btn" class="zoom-btn" onclick="resetZoom()" title="Reset zoom">⊙</button>
                </div>
                <svg id="map" viewBox="0 0 700 600" preserveAspectRatio="xMidYMid meet">
                    <defs>
                        <!-- Land gradient used as base for patterns -->
                        <linearGradient id="landGradient" x1="0%" y1="0%" x2="100%" y2="100%">
                            <stop offset="0%" stop-color="#c85a3a" />
                            <stop offset="60%" stop-color="#e0a56f" />
                        </linearGradient>

                        <!-- Base pattern (fallback) using external texture overlay -->
                        <pattern id="landPatternBase" patternUnits="userSpaceOnUse" width="700" height="600">
                            <rect width="700" height="600" fill="url(#landGradient)" />
                            <image href="assets/land-texture.svg" width="700" height="600" opacity="0.06" preserveAspectRatio="xMidYMid slice" />
                        </pattern>

                        <!-- Water gradient and glow -->
                        <linearGradient id="waterGradient" x1="0%" y1="0%" x2="100%" y2="0%">
                            <stop offset="0%" stop-color="#3b82c4" />
                            <stop offset="100%" stop-color="#176fb0" />
                        </linearGradient>

                        <filter id="waterGlow" x="-50%" y="-50%" width="200%" height="200%">
                            <feGaussianBlur stdDeviation="6" result="blur" />
                            <feMerge>
                                <feMergeNode in="blur" />
                                <feMergeNode in="SourceGraphic" />
                            </feMerge>
                        </filter>

                        <filter id="shadow" x="-50%" y="-50%" width="200%" height="200%">
                            <feDropShadow dx="0" dy="2" stdDeviation="4" flood-color="#000" flood-opacity="0.18" />
                        </filter>
                    </defs>

                    <!-- Map will be drawn here -->
                </svg>
            </div>

            <div class="question-container">
                <h2 id="question">Wat is de naam van het gemarkeerde gebied?</h2>
                <input type="text" id="answer-input" placeholder="Voer je antwoord in..." autocomplete="off">
                <button id="submit-btn" onclick="checkAnswer()">Controleer</button>
                <div id="feedback" class="feedback"></div>
            </div>

            <div class="controls">
                <button id="start-btn" onclick="startGame()">Start Spel</button>
                <button id="next-btn" onclick="nextQuestion()" style="display: none;">Volgende</button>
                <button id="restart-btn" onclick="restartGame()" style="display: none;">Opnieuw Spelen</button>
            </div>
        </div>

        <footer>
            <p>© 2025 Topotest - Een educatief spel voor kinderen | 
            <a href="https://github.com/commjoen/Topotest" target="_blank" rel="noopener noreferrer">Broncode op GitHub</a></p>
            <p class="practice-link">Wil je oefenen, zonder de namen te hoeven spellen? Kijk dan eens naar <a href="https://www.topografie-nederland.nl/" target="_blank" rel="noopener noreferrer">https://www.topografie-nederland.nl/</a>.</p>
        </footer>
    </div>

    <script>
        // Try to load d3.js from multiple CDN sources
        (function() {
            const cdnSources = [
                'https://d3js.org/d3.v7.min.js',
                'https://cdn.jsdelivr.net/npm/d3@7/dist/d3.min.js',
                'https://unpkg.com/d3@7/dist/d3.min.js'
            ];
            
            let loaded = false;
            let currentIndex = 0;
            
            function tryLoadD3() {
                if (currentIndex >= cdnSources.length) {
                    console.warn('All d3.js CDN sources failed to load. Level 3 and 4 will use fallback rendering.');
                    return;
                }
                
                const script = document.createElement('script');
                script.src = cdnSources[currentIndex];
                script.onload = function() {
                    loaded = true;
                    console.log('d3.js loaded successfully from:', cdnSources[currentIndex]);
                };
                script.onerror = function() {
                    console.warn('Failed to load d3.js from:', cdnSources[currentIndex]);
                    currentIndex++;
                    tryLoadD3();
                };
                document.head.appendChild(script);
            }
            
            tryLoadD3();
        })();
    </script>
    <script src="game.js"></script>
</body>
</html>
